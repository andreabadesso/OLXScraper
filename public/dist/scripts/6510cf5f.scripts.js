"use strict";angular.module("olxprecoApp",["ngCookies","ngResource","ngSanitize","ngRoute","angles"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).otherwise({redirectTo:"/"})}]);var angles=angular.module("angles",[]);angles.chart=function(a){return{restrict:"A",scope:{data:"=",options:"=",id:"@",width:"=",height:"=",resize:"=",chart:"@"},link:function(b,c){var d=c[0].getContext("2d"),e=!1;b.size=function(){b.width<=0?(c.width(c.parent().width()),d.canvas.width=c.width()):(d.canvas.width=b.width||d.canvas.width,e=!0),b.height<=0?(c.height(c.parent().height()),d.canvas.height=d.canvas.width/2):(d.canvas.height=b.height||d.canvas.height,e=!0)},b.$watch("data",function(c){if(c){if(b.chart&&(a=b.chart),e)b.size(),f=new Chart(d);else if(!c)return;f[a](b.data,b.options)}},!0),b.resize&&(angular.element(window).bind("resize",function(){b.size(),f=new Chart(d),f[a](b.data,b.options)}),b.$on("$destroy",function(){angular.element(window).off()})),b.size();var f=new Chart(d)}}},angles.directive("chart",function(){return angles.chart()}),angles.directive("linechart",function(){return angles.chart("Line")}),angles.directive("barchart",function(){return angles.chart("Bar")}),angles.directive("radarchart",function(){return angles.chart("Radar")}),angles.directive("polarchart",function(){return angles.chart("PolarArea")}),angles.directive("piechart",function(){return angles.chart("Pie")}),angles.directive("doughnutchart",function(){return angles.chart("Doughnut")}),angles.directive("donutchart",function(){return angles.chart("Doughnut")}),angular.module("olxprecoApp").controller("MainCtrl",["$scope","$http",function(a,b){a.opcoes=[{name:"Últimos 7 dias",id:1},{name:"Últimos 15 dias",id:2},{name:"Últimos 30 dias",id:3}];var c=[];c[1]="7",c[2]="15",c[3]="30",a.buscar=function(){b({method:"GET",url:"http://localhost:3000/ofertas/"+a.nome_produto+"/"+c[a.selecionado.id]}).success(function(b){a.data={labels:_.pluck(b,"data"),datasets:[{fillColor:"rgba(0,118,190,0.1)",strokeColor:"rgba(0,118,190,1)",pointColor:"rgba(220,220,220,1)",pointStrokeColor:"#0076BE",data:_.pluck(b,"preco")}]}}).error(function(){})},a.selecionado=a.opcoes[0],a.$watch("selecionado",function(){b({method:"GET",url:"http://localhost:3000/ofertas/"+a.nome_produto+"/"+c[a.selecionado.id]}).success(function(b){a.data={labels:_.pluck(b,"data"),datasets:[{fillColor:"rgba(0,118,190,0.1)",strokeColor:"rgba(0,118,190,1)",pointColor:"rgba(220,220,220,1)",pointStrokeColor:"#0076BE",data:_.pluck(b,"preco")}]}}).error(function(){})})}]);